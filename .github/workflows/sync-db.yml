name: Sync DB   # ðŸ‘ˆ this is the workflow name, shows as button in Actions

on:
  workflow_dispatch:   # ðŸ‘ˆ manual trigger

jobs:
  sync:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v3

      - name: Dump and Restore using MongoDB Docker
        run: |
          docker run --rm -v $PWD:/dump \
            --network=host mongo:7 bash -c "
              mongodump --uri='${{ secrets.MONGO_PROD_URI }}' --out=/dump &&
              mongorestore --uri='${{ secrets.MONGO_DEV_URI }}' --drop /dump
            "
